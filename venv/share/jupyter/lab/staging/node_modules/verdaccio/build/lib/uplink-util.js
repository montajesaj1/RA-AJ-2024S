"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.setupUpLinks = setupUpLinks;
exports.updateVersionsHiddenUpLink = updateVersionsHiddenUpLink;
var _upStorage = _interopRequireDefault(require("./up-storage"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
/**
 * Set up the Up Storage for each link.
 */
function setupUpLinks(config) {
  const uplinks = {};
  for (const uplinkName in config.uplinks) {
    if (Object.prototype.hasOwnProperty.call(config.uplinks, uplinkName)) {
      // instance for each up-link definition
      const proxy = new _upStorage.default(config.uplinks[uplinkName], config);
      proxy.upname = uplinkName;
      uplinks[uplinkName] = proxy;
    }
  }
  return uplinks;
}
function updateVersionsHiddenUpLink(versions, upLink) {
  for (const i in versions) {
    if (Object.prototype.hasOwnProperty.call(versions, i)) {
      const version = versions[i];

      // holds a "hidden" value to be used by the package storage.

      version[Symbol.for('__verdaccio_uplink')] = upLink.upname;
    }
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdXBTdG9yYWdlIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJvYmoiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsInNldHVwVXBMaW5rcyIsImNvbmZpZyIsInVwbGlua3MiLCJ1cGxpbmtOYW1lIiwiT2JqZWN0IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwicHJveHkiLCJQcm94eVN0b3JhZ2UiLCJ1cG5hbWUiLCJ1cGRhdGVWZXJzaW9uc0hpZGRlblVwTGluayIsInZlcnNpb25zIiwidXBMaW5rIiwiaSIsInZlcnNpb24iLCJTeW1ib2wiLCJmb3IiXSwic291cmNlcyI6WyIuLi8uLi9zcmMvbGliL3VwbGluay11dGlsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbmZpZywgVmVyc2lvbnMgfSBmcm9tICdAdmVyZGFjY2lvL3R5cGVzJztcblxuaW1wb3J0IFByb3h5U3RvcmFnZSBmcm9tICcuL3VwLXN0b3JhZ2UnO1xuXG4vKipcbiAqIFNldCB1cCB0aGUgVXAgU3RvcmFnZSBmb3IgZWFjaCBsaW5rLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0dXBVcExpbmtzKGNvbmZpZzogQ29uZmlnKTogUmVjb3JkPHN0cmluZywgUHJveHlTdG9yYWdlPiB7XG4gIGNvbnN0IHVwbGlua3MgPSB7fTtcblxuICBmb3IgKGNvbnN0IHVwbGlua05hbWUgaW4gY29uZmlnLnVwbGlua3MpIHtcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGNvbmZpZy51cGxpbmtzLCB1cGxpbmtOYW1lKSkge1xuICAgICAgLy8gaW5zdGFuY2UgZm9yIGVhY2ggdXAtbGluayBkZWZpbml0aW9uXG4gICAgICBjb25zdCBwcm94eSA9IG5ldyBQcm94eVN0b3JhZ2UoY29uZmlnLnVwbGlua3NbdXBsaW5rTmFtZV0sIGNvbmZpZyk7XG4gICAgICBwcm94eS51cG5hbWUgPSB1cGxpbmtOYW1lO1xuXG4gICAgICB1cGxpbmtzW3VwbGlua05hbWVdID0gcHJveHk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHVwbGlua3M7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVWZXJzaW9uc0hpZGRlblVwTGluayh2ZXJzaW9uczogVmVyc2lvbnMsIHVwTGluayk6IHZvaWQge1xuICBmb3IgKGNvbnN0IGkgaW4gdmVyc2lvbnMpIHtcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHZlcnNpb25zLCBpKSkge1xuICAgICAgY29uc3QgdmVyc2lvbiA9IHZlcnNpb25zW2ldO1xuXG4gICAgICAvLyBob2xkcyBhIFwiaGlkZGVuXCIgdmFsdWUgdG8gYmUgdXNlZCBieSB0aGUgcGFja2FnZSBzdG9yYWdlLlxuXG4gICAgICB2ZXJzaW9uW1N5bWJvbC5mb3IoJ19fdmVyZGFjY2lvX3VwbGluaycpXSA9IHVwTGluay51cG5hbWU7XG4gICAgfVxuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFFQSxJQUFBQSxVQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBd0MsU0FBQUQsdUJBQUFFLEdBQUEsV0FBQUEsR0FBQSxJQUFBQSxHQUFBLENBQUFDLFVBQUEsR0FBQUQsR0FBQSxLQUFBRSxPQUFBLEVBQUFGLEdBQUE7QUFFeEM7QUFDQTtBQUNBO0FBQ08sU0FBU0csWUFBWUEsQ0FBQ0MsTUFBYyxFQUFnQztFQUN6RSxNQUFNQyxPQUFPLEdBQUcsQ0FBQyxDQUFDO0VBRWxCLEtBQUssTUFBTUMsVUFBVSxJQUFJRixNQUFNLENBQUNDLE9BQU8sRUFBRTtJQUN2QyxJQUFJRSxNQUFNLENBQUNDLFNBQVMsQ0FBQ0MsY0FBYyxDQUFDQyxJQUFJLENBQUNOLE1BQU0sQ0FBQ0MsT0FBTyxFQUFFQyxVQUFVLENBQUMsRUFBRTtNQUNwRTtNQUNBLE1BQU1LLEtBQUssR0FBRyxJQUFJQyxrQkFBWSxDQUFDUixNQUFNLENBQUNDLE9BQU8sQ0FBQ0MsVUFBVSxDQUFDLEVBQUVGLE1BQU0sQ0FBQztNQUNsRU8sS0FBSyxDQUFDRSxNQUFNLEdBQUdQLFVBQVU7TUFFekJELE9BQU8sQ0FBQ0MsVUFBVSxDQUFDLEdBQUdLLEtBQUs7SUFDN0I7RUFDRjtFQUVBLE9BQU9OLE9BQU87QUFDaEI7QUFFTyxTQUFTUywwQkFBMEJBLENBQUNDLFFBQWtCLEVBQUVDLE1BQU0sRUFBUTtFQUMzRSxLQUFLLE1BQU1DLENBQUMsSUFBSUYsUUFBUSxFQUFFO0lBQ3hCLElBQUlSLE1BQU0sQ0FBQ0MsU0FBUyxDQUFDQyxjQUFjLENBQUNDLElBQUksQ0FBQ0ssUUFBUSxFQUFFRSxDQUFDLENBQUMsRUFBRTtNQUNyRCxNQUFNQyxPQUFPLEdBQUdILFFBQVEsQ0FBQ0UsQ0FBQyxDQUFDOztNQUUzQjs7TUFFQUMsT0FBTyxDQUFDQyxNQUFNLENBQUNDLEdBQUcsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLEdBQUdKLE1BQU0sQ0FBQ0gsTUFBTTtJQUMzRDtFQUNGO0FBQ0YifQ==