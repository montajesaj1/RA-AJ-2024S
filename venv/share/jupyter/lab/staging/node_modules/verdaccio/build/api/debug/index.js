"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _lodash = _interopRequireDefault(require("lodash"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
var _default = (app, selfPath) => {
  // Hook for tests only
  app.get('/-/_debug', function (req, res, next) {
    const doGarbabeCollector = _lodash.default.isNil(global.gc) === false;
    if (doGarbabeCollector) {
      // @ts-ignore
      global.gc();
    }
    next({
      pid: process.pid,
      // @ts-ignore
      main: process.mainModule.filename,
      conf: selfPath,
      mem: process.memoryUsage(),
      gc: doGarbabeCollector
    });
  });
};
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbG9kYXNoIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJvYmoiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIl9kZWZhdWx0IiwiYXBwIiwic2VsZlBhdGgiLCJnZXQiLCJyZXEiLCJyZXMiLCJuZXh0IiwiZG9HYXJiYWJlQ29sbGVjdG9yIiwiXyIsImlzTmlsIiwiZ2xvYmFsIiwiZ2MiLCJwaWQiLCJwcm9jZXNzIiwibWFpbiIsIm1haW5Nb2R1bGUiLCJmaWxlbmFtZSIsImNvbmYiLCJtZW0iLCJtZW1vcnlVc2FnZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvYXBpL2RlYnVnL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcGxpY2F0aW9uIH0gZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuXG5pbXBvcnQgeyAkTmV4dEZ1bmN0aW9uVmVyLCAkUmVxdWVzdEV4dGVuZCwgJFJlc3BvbnNlRXh0ZW5kIH0gZnJvbSAnLi4vLi4vdHlwZXMnO1xuXG5leHBvcnQgZGVmYXVsdCAoYXBwOiBBcHBsaWNhdGlvbiwgc2VsZlBhdGg6IHN0cmluZyk6IHZvaWQgPT4ge1xuICAvLyBIb29rIGZvciB0ZXN0cyBvbmx5XG4gIGFwcC5nZXQoXG4gICAgJy8tL19kZWJ1ZycsXG4gICAgZnVuY3Rpb24gKHJlcTogJFJlcXVlc3RFeHRlbmQsIHJlczogJFJlc3BvbnNlRXh0ZW5kLCBuZXh0OiAkTmV4dEZ1bmN0aW9uVmVyKTogdm9pZCB7XG4gICAgICBjb25zdCBkb0dhcmJhYmVDb2xsZWN0b3IgPSBfLmlzTmlsKGdsb2JhbC5nYykgPT09IGZhbHNlO1xuXG4gICAgICBpZiAoZG9HYXJiYWJlQ29sbGVjdG9yKSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgZ2xvYmFsLmdjKCk7XG4gICAgICB9XG5cbiAgICAgIG5leHQoe1xuICAgICAgICBwaWQ6IHByb2Nlc3MucGlkLFxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIG1haW46IHByb2Nlc3MubWFpbk1vZHVsZS5maWxlbmFtZSxcbiAgICAgICAgY29uZjogc2VsZlBhdGgsXG4gICAgICAgIG1lbTogcHJvY2Vzcy5tZW1vcnlVc2FnZSgpLFxuICAgICAgICBnYzogZG9HYXJiYWJlQ29sbGVjdG9yLFxuICAgICAgfSk7XG4gICAgfVxuICApO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ0EsSUFBQUEsT0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQXVCLFNBQUFELHVCQUFBRSxHQUFBLFdBQUFBLEdBQUEsSUFBQUEsR0FBQSxDQUFBQyxVQUFBLEdBQUFELEdBQUEsS0FBQUUsT0FBQSxFQUFBRixHQUFBO0FBQUEsSUFBQUcsUUFBQSxHQUlSQSxDQUFDQyxHQUFnQixFQUFFQyxRQUFnQixLQUFXO0VBQzNEO0VBQ0FELEdBQUcsQ0FBQ0UsR0FBRyxDQUNMLFdBQVcsRUFDWCxVQUFVQyxHQUFtQixFQUFFQyxHQUFvQixFQUFFQyxJQUFzQixFQUFRO0lBQ2pGLE1BQU1DLGtCQUFrQixHQUFHQyxlQUFDLENBQUNDLEtBQUssQ0FBQ0MsTUFBTSxDQUFDQyxFQUFFLENBQUMsS0FBSyxLQUFLO0lBRXZELElBQUlKLGtCQUFrQixFQUFFO01BQ3RCO01BQ0FHLE1BQU0sQ0FBQ0MsRUFBRSxDQUFDLENBQUM7SUFDYjtJQUVBTCxJQUFJLENBQUM7TUFDSE0sR0FBRyxFQUFFQyxPQUFPLENBQUNELEdBQUc7TUFDaEI7TUFDQUUsSUFBSSxFQUFFRCxPQUFPLENBQUNFLFVBQVUsQ0FBQ0MsUUFBUTtNQUNqQ0MsSUFBSSxFQUFFZixRQUFRO01BQ2RnQixHQUFHLEVBQUVMLE9BQU8sQ0FBQ00sV0FBVyxDQUFDLENBQUM7TUFDMUJSLEVBQUUsRUFBRUo7SUFDTixDQUFDLENBQUM7RUFDSixDQUNGLENBQUM7QUFDSCxDQUFDO0FBQUFhLE9BQUEsQ0FBQXJCLE9BQUEsR0FBQUMsUUFBQSJ9