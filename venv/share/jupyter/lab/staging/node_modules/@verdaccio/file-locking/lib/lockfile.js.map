{"version":3,"file":"lockfile.js","names":["_utils","require","lockFile","name","callback","Promise","resolve","then","statDir","statfile","lockfile","catch","err","exports"],"sources":["../src/lockfile.ts"],"sourcesContent":["import fs from 'fs';\n\nimport locker from 'lockfile';\nimport { Callback } from '@verdaccio/legacy-types';\n\nimport { lockfile, statDir, statfile } from './utils';\n\n/**\n * locks a file by creating a lock file\n * @param name\n * @param callback\n */\nconst lockFile = function(name: string, callback: Callback): void {\n  Promise.resolve()\n    .then(() => {\n      return statDir(name);\n    })\n    .then(() => {\n      return statfile(name);\n    })\n    .then(() => {\n      return lockfile(name);\n    })\n    .then(() => {\n      callback(null);\n    })\n    .catch(err => {\n      callback(err);\n    });\n};\n\nexport { lockFile };\n"],"mappings":";;;;;;AAKA,IAAAA,MAAA,GAAAC,OAAA;AAEA;AACA;AACA;AACA;AACA;AACA,MAAMC,QAAQ,GAAG,SAAAA,CAASC,IAAY,EAAEC,QAAkB,EAAQ;EAChEC,OAAO,CAACC,OAAO,EAAE,CACdC,IAAI,CAAC,MAAM;IACV,OAAO,IAAAC,cAAO,EAACL,IAAI,CAAC;EACtB,CAAC,CAAC,CACDI,IAAI,CAAC,MAAM;IACV,OAAO,IAAAE,eAAQ,EAACN,IAAI,CAAC;EACvB,CAAC,CAAC,CACDI,IAAI,CAAC,MAAM;IACV,OAAO,IAAAG,eAAQ,EAACP,IAAI,CAAC;EACvB,CAAC,CAAC,CACDI,IAAI,CAAC,MAAM;IACVH,QAAQ,CAAC,IAAI,CAAC;EAChB,CAAC,CAAC,CACDO,KAAK,CAACC,GAAG,IAAI;IACZR,QAAQ,CAACQ,GAAG,CAAC;EACf,CAAC,CAAC;AACN,CAAC;AAACC,OAAA,CAAAX,QAAA,GAAAA,QAAA"}